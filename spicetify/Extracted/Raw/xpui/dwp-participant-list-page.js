"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[987],{84816:(e,s,n)=>{n.d(s,{B:()=>W});var t=n(30758),i=n(62411),r=n(31417),o=n(10994),a=n(10137),l=n(98293),c=n(12864),u=n(53133),d=n(89402),m=n(39566),p=n(44672),b=n(66530),g=n(1599),x=n(46441),f=n(98822),k=n(86070);const v=({currentUserUri:e,uri:s,name:n,divider:o})=>{const p=(0,d.W)(),v=!(0,m.n)(),{isBlocked:h,blockUser:w,unblockUser:C}=function(e,s,n){const[o,a]=(0,t.useState)(!1),c=(0,i.wA)(),d=(0,b.a)(),m=(0,f.A)(),{enqueueSnackbar:p}=(0,u.d)();return(0,t.useEffect)((()=>{e&&(0,x.zP)(m,{currentUserUri:e,uri:s}).then((e=>{if(d()){if(200!==e.status)throw new Error("Invalid response from socialgraph");a(e.body?.[0]?.is_dismissed||!1)}}))}),[e,s,d,m]),{isBlocked:o,blockUser:()=>{e&&c((0,l.zj)(s,n))},unblockUser:async()=>{e&&(await(0,x.kV)(g.n.getInstance(),{currentUserUri:e,uri:s}),p(r.Ru.get("feedback.unblock-user")))}}}(e,s,n),j=(0,t.useCallback)((async()=>{p({targetUri:s,intent:h?"unblock":"block",type:"click"}),h?await C():await w()}),[p,s,w,C,h]);if(!e||e===s)return null;const R=h?r.Ru.get("contextmenu.unblock"):r.Ru.get("contextmenu.block");return(0,k.jsx)(c.D,{role:"menuitem",divider:o,disabled:v,onClick:j,leadingIcon:(0,k.jsx)(a.V,{semanticColor:"textSubdued",size:"small"}),children:R})},h=t.memo((function(e){return(0,k.jsx)(p.pZ,{value:"block-user",children:(0,k.jsx)(v,{...e})})}));var w=n(59521),C=n(9931);const j=t.memo((function({onClick:e,divider:s,canEdit:n}){return e&&n?(0,k.jsx)(p.pZ,{value:"edit-profile",children:(0,k.jsx)(c.D,{role:"menuitem",divider:s,onClick:e,leadingIcon:(0,k.jsx)(C.G,{semanticColor:"textSubdued",size:"small"}),children:r.Ru.get("contextmenu.edit-profile")})}):null}));var R=n(45415),y=n(91488),U=n(36749),I=n(75514),S=n(36061),B=n(21549);const N=()=>{},E=({uri:e,divider:s,onRemoveCallback:n=N})=>{const{spec:o,logger:a}=(0,B.r)(U.F,{data:{uri:e}}),l=(0,d.W)(),u=!(0,m.n)(),p=(0,i.d4)(S.Ht).user,[b,g]=(0,I.Y)(e),x=(0,t.useCallback)((()=>{const s=o.followButtonFactory();l({targetUri:e,intent:b?"unfollow":"follow",type:"click"}),b?(g(!1),a.logInteraction(s.hitUnfollow({itemToBeUnfollowed:e})),n(e)):(g(!0),a.logInteraction(s.hitFollow({itemToBeFollowed:e})))}),[b,a,l,n,g,o,e]);if(p&&p.uri===e)return null;const f=b?r.Ru.get("contextmenu.unfollow"):r.Ru.get("contextmenu.follow");return(0,k.jsx)(c.D,{role:"menuitem",testid:"follow-user-context-menu-item",divider:s,disabled:u,onClick:x,leadingIcon:b?(0,k.jsx)(R.M,{semanticColor:"textBrightAccent",size:"small"}):(0,k.jsx)(y.h,{semanticColor:"textSubdued",size:"small"}),children:f})},M=t.memo((function(e){return(0,k.jsx)(p.pZ,{value:"follow-user",children:(0,k.jsx)(E,{...e})})}));var F=n(69476),T=n(15526),O=n(47756),A=n(69693),_=n(10565),P=n(81222);function L({userUri:e}){const{currentSession:s}=(0,A.D)(),n=(0,_.d)(),o=(0,i.wA)(),a=(0,t.useCallback)((()=>{const n=(0,P.Bj)(s?.sessionMembers??[],e);n&&o((0,l.A9)(O.EL.REMOVE_PARTICIPANT,void 0,n))}),[s?.sessionMembers,o,e]),u=(0,P.kt)(n,e);return s?.active&&e&&u?(0,k.jsx)(c.D,{role:"menuitem",onClick:a,leadingIcon:(0,k.jsx)(T.f,{semanticColor:"textSubdued",size:"small"}),children:r.Ru.get("web-player.social-connect.kick-users.remove-the-user")}):(0,k.jsx)(k.Fragment,{})}var z=n(98655),D=n(78774);const W=t.memo((function({uri:e,onEditProfileCallback:s}){const{user:n}=(0,i.d4)(S.Ht),{spec:t}=(0,D.o)(e),{data:a,loading:l}=(0,z.Z)(x.E$,[{uri:e}]);return l?null:a?(0,k.jsx)(p.pZ,{value:"user",children:(0,k.jsxs)(o.W,{children:[(0,k.jsx)(M,{uri:e}),(0,k.jsx)(L,{userUri:e}),(0,k.jsx)(h,{uri:a.uri,name:a.name,currentUserUri:n?.uri}),(0,k.jsx)(j,{onClick:s,canEdit:!(e!==n?.uri||a.edit_image_disabled&&a.edit_name_disabled)}),(0,k.jsx)(F.P,{spec:t,uri:e,canReportUser:!a.report_abuse_disabled,currentUserUri:n?.uri}),(0,k.jsx)(w.m,{spec:t,uri:e,displayText:r.Ru.get("contextmenu.share.copy-profile-link")})]})}):null}))},7800:(e,s,n)=>{n.d(s,{ParticipantListPage:()=>N});var t=n(30758),i=n(62411),r=n(85387),o=n(422),a=n(91008),l=n(31417),c=n(86040),u=n(15292),d=n(26344),m=n(70981),p=n(69693),b=n(86070);const g=({memberToBeRemoved:e,onClose:s})=>{const{logRemoveClick:n}=(0,m.R)(),{currentSession:i,removeSessionMember:r}=(0,p.D)(),o=e?.id??"",a=e?.displayName??"",c=i?.sessionId??"",u=(0,t.useCallback)((()=>{n(o,c),o&&(r(o),s())}),[n,o,c,r,s]),g=(0,t.useCallback)((()=>{s()}),[s]);return(0,b.jsx)(d.T,{isOpen:Boolean(o),titleText:l.Ru.get("web-player.social-connect.participant-list.remove-guest-dialog",{displayName:a}),"aria-label":l.Ru.get("web-player.social-connect.participant-list.remove-guest-dialog",{displayName:a}),confirmText:l.Ru.get("web-player.social-connect.participant-list.remove-guest"),cancelText:l.Ru.get("web-player.social-connect.participant-list.remove-guest-cancel"),onConfirm:u,onClose:g})};var x=n(56515),f=n(89845),k=n(18377),v=n(41616),h=n(65462),w=n(84816),C=n(21082),j=n(64333);const R="VaoPVkde4AzxorQnp6Jp",y="dDz8CzVKiV2128rhR543",U="tBAiRbWhD79Gi2XqZ_AG",I=({sessionMember:e,index:s,showRemoveButton:n,onClickRemove:t,onClickMember:i})=>{const{displayName:r,images:a,uri:c,username:u}=(0,j.c)(e);return(0,b.jsx)(h.h,{menu:(0,b.jsx)(w.B,{uri:c}),children:(0,b.jsx)("span",{children:(0,b.jsxs)(k.$,{rowIndex:s,className:R,children:[(0,b.jsx)(f.T,{columnIndex:0,children:(0,b.jsxs)(C.N,{to:c,className:U,onClick:i,"aria-label":r,children:[(0,b.jsx)(v.e,{images:a,userIconSize:"medium",width:32,displayName:r,username:u,label:r}),(0,b.jsx)(o.E,{as:"p",variant:"bodyMediumBold",semanticColor:"textBase",children:r})]})}),n&&(0,b.jsx)(f.T,{columnIndex:1,className:y,children:(0,b.jsx)(x.n,{size:"small",onClick:t,"aria-label":l.Ru.get("web-player.social-connect.participant-list.remove-guest-accessible-label",{displayName:r}),children:l.Ru.get("web-player.social-connect.participant-list.remove-guest")})})]})})})};var S=n(38999);const B="qAE8wMAxO5THZoNqlb0q",N=()=>{const e=(0,i.d4)((e=>e.session.user?.id)),{currentSession:s}=(0,p.D)(),[n,d]=(0,t.useState)(),{logUserClick:m,logRemoveClick:x,UBIFragmentWithSpec:f}=(0,S.T)(),k=(0,t.useCallback)(((e,s)=>{x(e),d(s)}),[x]),v=(0,t.useCallback)(((e,s)=>{const n=(0,a.Qjr)(s.username).toURI();m(e,n)}),[m]),h=(0,t.useCallback)((()=>{d(void 0)}),[]),w=s?.sessionMembers.find((e=>e.id===s.sessionOwnerId));if(!s||!w)return(0,b.jsx)(r.C5,{to:"/queue"});const C=s.isSessionOwner?2:1;return(0,b.jsxs)("section",{className:"contentSpacing",children:[(0,b.jsx)(u.Q,{children:l.Ru.get("web-player.social-connect.participant-list.title",{host:w.displayName})}),(0,b.jsx)(o.E,{as:"h1",variant:"titleSmall",semanticColor:"textBase",children:l.Ru.get("web-player.social-connect.participant-list.title")}),(0,b.jsx)(o.E,{as:"h2",variant:"bodyMediumBold",semanticColor:"textSubdued",children:l.Ru.get("web-player.social-connect.participant-list.subtitle")}),(0,b.jsx)(c.f,{"aria-colcount":C,"aria-rowcount":s.sessionMembers.length,"aria-label":l.Ru.get("web-player.social-connect.participant-list.title"),className:B,children:s.sessionMembers.map(((n,t)=>(0,b.jsx)(I,{sessionMember:n,showRemoveButton:s.isSessionOwner&&n.username!==e,index:t,onClickRemove:()=>k(t,n),onClickMember:()=>v(t,n)},n.displayName)))}),(0,b.jsx)(f,{children:(0,b.jsx)(g,{memberToBeRemoved:n,onClose:h})})]})}},38999:(e,s,n)=>{n.d(s,{T:()=>a});var t=n(30758),i=n(49101),r=n(21549),o=n(86070);const a=()=>{const{spec:e,logger:s,UBIFragment:n}=(0,r.r)(i.I,{});return{logUserClick:(0,t.useCallback)(((n,t)=>{s.logInteraction(e.participantListFactory().participantListRowFactory({position:n}).userLinkFactory().hitUiNavigate({destination:t}))}),[s,e]),logRemoveClick:(0,t.useCallback)((n=>{s.logInteraction(e.participantListFactory().participantListRowFactory({position:n}).removeButtonFactory().hitUiReveal())}),[s,e]),UBIFragmentWithSpec:(0,t.useCallback)((s=>(0,o.jsx)(n,{spec:e,...s})),[n,e])}}},75514:(e,s,n)=>{n.d(s,{Y:()=>l});var t=n(30758),i=n(91008),r=n(65924),o=n(81122),a=n(12130);const l=e=>{const s=(0,o.f)(),[n,l]=(0,t.useState)(!1);if(!(0,i.APS)(e))throw new Error(`Expected a Spotify uri in format 'spotify:user:***', got "${e}"`);const c=(0,t.useCallback)((t=>t&&!n?s.followUsers([e]):!t&&n?s.unfollowUsers([e]):Promise.resolve()),[s,n,e]);return(0,t.useEffect)((()=>{l(!1),s.isFollowing([e]).then((s=>{l(s[e]??!1)}))}),[s,e]),(0,a.N)(r.mc.OPERATION_COMPLETE,(s=>{s.data.uris.includes(e)&&!s.data.error&&(s.data.operation===r.JK.FOLLOW_USER?l(!0):s.data.operation===r.JK.UNFOLLOW_USER&&l(!1))})),[n,c]}},64333:(e,s,n)=>{n.d(s,{c:()=>r,t:()=>o});var t=n(91008);const i=e=>({url:e}),r=e=>{const s=[];return e.largeImageUrl?s.push(i(e.largeImageUrl)):e.imageUrl&&s.push(i(e.imageUrl)),{displayName:e.displayName,images:s,username:e.username,uri:(0,t.Qjr)(e.username).toURI()}},o=(e,s,n)=>{const t=[],i=e.sessionMembers.find((({id:s})=>s===e.sessionOwnerId));i&&t.push(i);const o=e.isSessionOwner?void 0:e?.sessionMembers.find((({username:e})=>e===s));o&&(n?.userFirst?t.unshift(o):t.push(o));const a=e.sessionMembers.filter((({username:n,id:t})=>t!==e.sessionOwnerId&&n!==s));return[...t,...a].map(r)}},70981:(e,s,n)=>{n.d(s,{R:()=>o});var t=n(30758),i=n(89007),r=n(21549);const o=()=>{const{spec:e,logger:s}=(0,r.r)(i.T,{});return{logRemoveClick:(0,t.useCallback)(((n,t)=>{s.logInteraction(e.buttonRowFactory().removeButtonFactory().hitRemoveParticipant({participantId:n,sessionId:t}))}),[s,e])}}},81122:(e,s,n)=>{n.d(s,{f:()=>r});var t=n(24109),i=n(30157);const r=()=>(0,i.N)(t.t)},12130:(e,s,n)=>{n.d(s,{N:()=>r});var t=n(30758),i=n(81122);const r=(e,s)=>{const n=(0,i.f)();(0,t.useEffect)((()=>n.getEvents().addListener(e,s)),[e,n,s])}},81222:(e,s,n)=>{n.d(s,{Bj:()=>i,T4:()=>r,kt:()=>o});var t=n(91008);function i(e,s){if(!s)return null;const n=(0,t.o_h)(s);if(!n||!(0,t.APS)(n))return null;const i=(0,t.XIp)(n.username);return e.find((e=>e.username===i))??null}function r(e){const s=e.getCurrentSession(),n=s?.sessionOwnerId;return n?s.sessionMembers.find((e=>e.id===n))??null:null}function o(e,s){if(!s||!function(e){return e.getCurrentSession()?.isSessionOwner??!1}(e))return!1;const n=e.getCurrentSession(),t=i(n?.sessionMembers??[],s),o=r(e);return!!t&&t?.username!==o?.username}}}]);
//# sourceMappingURL=dwp-participant-list-page.js.map