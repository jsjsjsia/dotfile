"use strict";(("undefined"!=typeof self?self:global).webpackChunkclient_web=("undefined"!=typeof self?self:global).webpackChunkclient_web||[]).push([[7988],{98676:(e,t,r)=>{r.d(t,{x:()=>T});const i="playback-bar",n="playback-bar__progress-time-elapsed",a="gglUjikTBtMzCZFgSmpS",s="dN6OLjjcmnuleiECu55A",o="DSdahCi0SDG37V9ZmsGO",l="playback-progressbar-container";var c=r(30758),d=r(97500),u=r.n(d),m=r(422),p=r(14343),v=r(31417),g=r(27607),f=r(68815),b=r(78505),x=r(62021),h=r(82935);const y="main-playbackBarRemainingTime-container";var C=r(86070);const w=({position:e,duration:t,isPreview:r,semanticColor:i="textSubdued",isFullscreenMode:n=!1,className:a})=>{const[s,o]=(0,x.x)(b.fC,!1),l=(0,c.useCallback)((()=>{r||o(!s)}),[s,o,r]);return(0,C.jsx)(m.E,{as:"div","data-testid":"playback-duration","data-test-position":e,variant:n?"bodyMedium":"marginal",className:u()(y,a),onClick:l,semanticColor:i,children:s?`-${(0,h.f)(t-e)}`:(0,h.f)(t)})};var N=r(77567),P=r(58685),j=r(5805);const k="Bn7RYdPUyzN4qo1bC1Ic",V="OEe8k2xe6o6x9x0FAc4b",E=[{name:"Anakin",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"7px","--core-color":"white","--edge-glow-color":"rgb(55, 132, 214)","--blur-glow-color":"#2e77d0","--blur-radius":"16px","--spread-radius":"8px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_anakin.png")})`,"--saber-hilt-overlap":"5px"}},{name:"Luke",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"9px","--core-color":"white","--edge-glow-color":"rgb(135, 220, 90)","--blur-glow-color":"#1ed760","--blur-radius":"16px","--spread-radius":"4px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_luke.png")})`,"--saber-hilt-overlap":"5px"}},{name:"Vader",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"10px","--core-color":"white","--edge-glow-color":"rgb(229, 17, 21)","--blur-glow-color":"#cd1a2b","--blur-radius":"20px","--spread-radius":"14px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_vader.png")})`,"--saber-hilt-overlap":"6px"}},{name:"Rey",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"8px","--core-color":"white","--edge-glow-color":"rgb(249, 164, 11)","--blur-glow-color":"rgb(253, 175, 33)","--blur-radius":"20px","--spread-radius":"5px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_rey.png")})`,"--saber-hilt-overlap":"3px"}},{name:"Leia",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"9px","--core-color":"white","--edge-glow-color":"rgb(55, 132, 214)","--blur-glow-color":"#2e77d0","--blur-radius":"16px","--spread-radius":"8px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_leia.png")})`,"--saber-hilt-overlap":"2px"}},{name:"Mace",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"9px","--core-color":"white","--edge-glow-color":"rgb(90, 22, 167)","--blur-glow-color":"rgb(172, 57, 193)","--blur-radius":"20px","--spread-radius":"8px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_mace.png")})`,"--saber-hilt-overlap":"1px"}},{name:"Ahsoka",vars:{"--bg-color":"","--fg-color":"transparent","--is-active-fg-color":"transparent","--progress-bar-height":"6px","--core-color":"white","--edge-glow-color":"rgb(255,255,255)","--blur-glow-color":"rgb(255,255,255)","--blur-radius":"20px","--spread-radius":"5px","--saber-hilt-url":`url(${(0,N.b)("images/sw_saber_ahsoka1.png")})`,"--saber-hilt-overlap":"-9px","--saber-hilt-width":"100px","--saber-hilt-height":"36px"}}],R=["spotify:playlist:37i9dQZF1DXaUaRhCgtpCo","spotify:playlist:69BOXIItwwyxTgdz6flzvU","spotify:playlist:37i9dQZF1DWUgUvAPAFxdh"],I=["official_star_wars","kirbysayshi","hansencc"],M=/Star Wars/i,L="THX1138",A=L.length;function O({onChange:e}){const t=function(){const[e,t]=(0,c.useState)([]),[r,i]=(0,c.useState)(!1);return(0,c.useEffect)((()=>{const n=n=>{for(e.push(n.key);e.length>A;)e.shift();e.join("")===L&&i(!r),t([...e])};return window.addEventListener("keypress",n),()=>{window.removeEventListener("keypress",n)}}),[e,r]),(0,P.o)((e=>{const t=e?.context.uri??"",r=e?.context?.metadata?.context_owner??"",i=e?.item??void 0;return!!R.includes(t)||!!I.includes(r)||!!(0,j.v)(i)&&(M.test(i.name)||M.test(i.album.name))}))||r}(),{next:r,config:i}=function(e){const[t,r]=(0,c.useState)(0);return{next:()=>{r((t+1)%E.length)},config:e?E[t]:null}}(t),n=(0,c.useRef)(e);return n.current=e,(0,c.useEffect)((()=>{n.current(i?.vars??null)}),[i]),i?(0,C.jsx)("div",{className:k,children:(0,C.jsx)("button",{"data-testid":"saber-hilt-button","aria-label":v.Ru.get("playback-control.a11y.lightsaber-hilt-button",i?.name),className:V,style:i.vars,onClick:r})}):null}var B=r(9473),_=r(90813);const S=["spotify:playlist:37i9dQZF1DXc3KPAjGyPdm"];var z=r(38501),F=r(87182),D=r(86931),U=r(43398);const W=1e3,T=({isPreview:e,isFullscreenMode:t=!1,timerPlacement:r="inline",onChange:d,onDragStart:b,onDragEnd:x})=>{const y=(0,p.NC)(z.O14),[N,j]=(0,c.useState)(null),k=(0,F.z)(),V=(0,P.o)((e=>e),((e,t)=>e?.duration===t?.duration&&e?.hasContext===t?.hasContext&&e?.restrictions?.canSeek===t?.restrictions?.canSeek)),{seekOffsetMs:E}=(0,U.p)(),R=V?.duration??0,I=V?.hasContext??!1,M=V?.restrictions?.canSeek??!1,[L,A,T]=(0,D.S)(W),[K,H]=(0,c.useState)(null),Z=null!==K?K:L,G=null!==K?K:L+(y&&!T?W:0),X=e=>{H(e*R),b?.()},Y=(Z>0||R>0)&&"true"!==V?.item?.metadata?.is_narration,q=(0,h.f)(Y?Z:NaN),$=(0,h.f)(Y?R:NaN),Q=function(){const e=(0,_.S)()!==B.z.CLOSED,t=(0,P.o)((e=>{const t=e?.context.uri??"";return S.includes(t)}));return!e&&t}(),J=(0,f.O)(),ee="above"===r?s:a;return(0,C.jsxs)("div",{className:u()(i,ee),children:["indicatorOnly"!==r&&(0,C.jsx)(m.E,{"data-testid":"playback-position",as:"div",variant:t?"bodyMedium":"marginal",className:n,semanticColor:t?"textBase":"textSubdued",children:q}),(0,C.jsxs)("div",{className:l,children:[I?(0,C.jsx)(O,{onChange:e=>{j(e)}}):null,(0,C.jsx)(g.z2,{labelText:v.Ru.get("playback-control.a11y.seek-slider-button"),value:G,updateFrequency:W,offFrequencyUpdate:T,max:R,step:E,"aria-valuetext":v.Ru.get("download.progress-global",q,$),isInteractive:I&&Y,onDragStart:X,onDragMove:X,onDragEnd:(e,{wasDraggedBeforeReleased:t})=>{if(H(null),x?.(),!M)return;const r=e*R;A(r),k.seekTo(r);const i=t?"drag":"hit";d?.(r,i)},saberConfig:N,isPlayingStrangerThings:Q,isAttackOnTitanEasterEggActive:J,"data-testid":"playback-progressbar",enableAnimation:y,showValueAsTimeOverHandle:"indicatorOnly"===r})]}),"indicatorOnly"!==r&&(0,C.jsx)(w,{position:Z,duration:Y?R:NaN,isPreview:e,semanticColor:t?"textBase":"textSubdued",isFullscreenMode:t,className:o})]})}},69711:(e,t,r)=>{r.d(t,{VideoPlayer:()=>Nt});var i=r(30758),n=r(62411),a=r(97500),s=r.n(a),o=r(85387),l=r(31417);var c=r(78813),d=r(44481),u=r(46159);const m="KopIqvLbHzuI_pYTXRSw";var p=r(86070);const v=({onMinimizeButtonClick:e})=>(0,p.jsx)("div",{className:s()(m),children:(0,p.jsx)(d.$,{"aria-label":l.Ru.get("ad-formats.dismissAd"),colorSet:"overMedia",iconOnly:u.b,onClick:e,size:"small"})});var g=r(32411),f=r(30714),b=r(44971),x=r(79961),h=r(9473),y=r(90813),C=r(58685),w=r(75497);const N="Lk23rM5uSl5mgEXroOPH",P="XvNci8tJYTXGgFBNzRWg",j="Hj1B5D7WgG4aZkU8meAp",k="ctQf8WC83qR_pcv7bOEh",V="Xyaz284GhueBbBPn6gOS",E="pIMAcTC5w2dZdMGe4U_A",R="XeZ0TCAoRGXh8soWVo5S",I=({setVideoContainer:e})=>{const t=(0,n.wA)(),r=(0,C.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri)),a=(0,w.N)(r)?r.url??void 0:void 0,d=((0,w.N)(r)?r.advertiser:void 0)||"Advertiser",u=(0,n.d4)((e=>e?.ads?.vto?.isMinimized)),m=(0,w.N)(r)&&"portrait"===r.videoOrientation,I=(0,i.useRef)(),M=(0,o.zy)(),L=(0,y.S)();(0,i.useEffect)((()=>{I.current?t((0,c.iB)()):I.current=!0}),[t,M.pathname]);const[A,O]=(0,i.useState)(null);(0,i.useEffect)((()=>{t((0,c.MW)())}),[t]),(0,i.useEffect)((()=>{null!==A&&e(A)}),[e,u,A]);const B=s()(N,{[P]:m});return(0,p.jsxs)(b.A,{className:j,animation:{overlay:{base:V,beforeClose:R,afterOpen:E},closeTimeoutMs:300},isOpen:!u,parentSelector:()=>document.querySelector(".VTO__modal-slot"),shouldCloseOnEsc:!1,shouldCloseOnOverlayClick:!1,contentLabel:l.Ru.get("ad-formats.advertisement"),children:[(0,p.jsxs)("div",{className:B,children:[(0,p.jsx)("a",{"aria-label":l.Ru.get("ad-formats.video-ad-overlay.cta-button",{advertiserName:d}),className:B,"data-testid":"video-takeover-link",href:a?(0,g.H)(a):void 0,onClick:()=>{t((0,c.i2)(f.ee.CLICKED,f.Wh.VIDEO_TAKEOVER,f.Lv.VIDEO_PLAYER))},ref:e=>{O(e)},target:"_blank"}),L===h.z.CLOSED&&(0,p.jsx)(v,{onMinimizeButtonClick:()=>{t((0,c.Oc)()),t((0,c.i2)(f.ee.COLLAPSED,f.Wh.MINIMIZE_BUTTON,f.Lv.VIDEO_PLAYER))}})]}),L===h.z.NOW_PLAYING_VIEW&&(0,w.N)(r)&&(0,p.jsx)(x.h,{item:r,className:k})]})},M=({setVideoContainer:e})=>(0,n.d4)((e=>e?.ads?.vto?.isHidden))?null:(0,p.jsx)(I,{setVideoContainer:e});var L=r(78464),A=r(8143),O=r(14343),B=r(40638);function _(){const[e,t]=(0,i.useState)(!1),r=(0,i.useRef)(null),n=(0,B.YQ)((()=>{r.current&&clearTimeout(r.current),r.current=setTimeout((()=>{t(!1)}),1500),t(!0)}),100,{maxWait:100,leading:!0}),a=(0,i.useCallback)((e=>{t(e),n.cancel()}),[n]);return(0,i.useEffect)((()=>()=>{r.current&&clearTimeout(r.current)}),[]),{isControlsVisible:e,setIsControlsVisible:a,handleKeepViewVisible:n}}var S=r(51100),z=r(46022),F=r(61286),D=r(60238),U=r(68594),W=r(74934),T=r(85771),K=r(33625),H=r(15155),Z=r(58147),G=r(66204),X=r(31193),Y=r(909),q=r(38501),$=r(608),Q=r(21549);const J="Wkw36VsNH5vn2NWdtLuR",ee="MBzbwWcyfbqSftBtnn3g",te=({noBackground:e,iconSize:t="small",className:r})=>{const{setVideoPlayerUIFlag:i,videoPlayerUIFlags:n,videoPlayerMode:a}=(0,X.d)(),o=a===Y.K.cinemaLegacy,{uri:c}=(0,$.f)(),{hideLyrics:d}=(0,G.A)({referrer:"cinema-mode-toggle"}),u=(0,O.NC)(q.Au4),{spec:m,logger:v}=(0,Q.r)(D.E,{data:{uri:c??"",identifier:Y.K.cinemaLegacy}});if(!u||a===Y.K.fullscreen)return null;return(0,p.jsx)("div",{className:s()({[ee]:o}),children:(0,p.jsx)(U.D,{noBackground:e,active:o,label:o?l.Ru.get("video-player.default-view"):l.Ru.get("video-player.cinema-mode"),onClick:()=>{o?v.logInteraction(m.cinemaModeButtonFactory().hitUiHide()):v.logInteraction(m.cinemaModeButtonFactory().hitUiReveal()),d(),i(Y.n.cinemaLegacy,!n.cinemaLegacy)},className:s()(J,r),children:o?(0,p.jsx)(H.Q,{size:t}):(0,p.jsx)(Z.C,{size:t})})})};var re=r(93523),ie=r(14732),ne=r(99701),ae=r(61301);const se=({className:e})=>{const t=(0,ae.l)(),r=(0,i.useCallback)((()=>{t(h.z.NOW_PLAYING_VIEW)}),[t]);return(0,p.jsx)(ne.Zp,{label:l.Ru.get("web-player.now-playing-view.cinema-mode.expand"),children:(0,p.jsx)(re.H,{iconOnly:ie.L,size:"small",onClick:r,"aria-label":l.Ru.get("web-player.now-playing-view.cinema-mode.expand"),semanticColor:"textBase",className:e})})};var oe=r(72285),le=r(60437),ce=r(92849),de=r(40339),ue=r(8428),me=r(32641);function pe(){const e=(0,n.wA)(),t=(0,de.XB)();return{enterPipVideoMode:(0,i.useCallback)((()=>{e((0,me.R)(Y.K.pip))}),[e]),leavePipVideoMode:(0,i.useCallback)((()=>{t===ue.Z.NowPlayingView&&e((0,me.R)(Y.K.npv))}),[e,t])}}var ve=r(93629),ge=r(16581);const fe="fuONPgUcYO2bf15HunlX",be=({noBackground:e,iconSize:t="small",uri:r})=>{const i=(0,n.d4)(le.c),a=i===Y.K.pip,{enterPipVideoMode:o,leavePipVideoMode:c}=pe(),{item:d}=(0,K.L)()??{},{isActive:u}=(0,ce.D)({item:d}),m=(0,C.o)(ge.A3),{spec:v,logger:g}=(0,Q.r)(D.E,{data:{uri:r,identifier:i}}),f=(0,oe.u)({parentAbsoluteLocation:v.pipButtonContainerFactory().getAbsoluteLocation()});if(!m)return null;let b=l.Ru.get("video-player.default-view");return a||(b=u?l.Ru.get("miniplayer.close"):l.Ru.get("miniplayer.open-in")),(0,p.jsx)("div",{className:s()({[fe]:a}),children:(0,p.jsx)(U.D,{noBackground:e,active:a,label:b,onClick:()=>{(0,ve.ge)()&&(0,ve.SP)(),a?(c(),g.logInteraction(f.pipButtonFactory({uri:r}).hitUiHide())):(o(),f.pipButtonFactory({uri:r}).hitUiReveal())},children:(0,p.jsx)(S.F,{size:t})})})};var xe=r(4088),he=r(98293),ye=r(62435),Ce=r(75032),we=r(78400);const Ne="aHe1QDDI5hmYWAKf4MoR",Pe="ACGZS5YQp3lxBSr4RKaF",je="DtWKCk0YYDlZT11U1niL",ke="RTSxo7zS2ozOeg4gnC2c",Ve="ZcIaDrsIojjWZ_Xf_6iN",Ee="viN5UfPr2XfnYOWHTS0W",Re="pLL2Ok4QckLG8GAWriCB",Ie="OrGQiDAXobDXrw9LVnnD",Me=()=>{const e=(0,ae.l)(),{isFullScreenSupported:t,toggleFullScreen:r}=(0,we.H)(document.body),n=(0,i.useCallback)((async()=>{try{await r()}catch(e){}e(h.z.NOW_PLAYING_VIEW)}),[e,r]);return t?(0,p.jsx)(ne.Zp,{label:l.Ru.get("npv.full-screen"),children:(0,p.jsx)(re.H,{iconOnly:Ce.T,size:"small",onClick:n,"aria-label":l.Ru.get("npv.full-screen"),semanticColor:"textBase",className:s()("encore-over-media-set",Pe)})}):null},Le=()=>{const e=(0,n.wA)(),t=(0,i.useContext)(ye.s),r=(0,i.useCallback)((()=>{t?.current&&((0,ve.X8)(t.current),e((0,he.f)()))}),[e,t]);return(0,p.jsx)(ne.Zp,{label:l.Ru.get("npv.full-screen"),children:(0,p.jsx)(re.H,{iconOnly:ie.L,size:"small","aria-label":l.Ru.get("npv.full-screen"),semanticColor:"textBase",onClick:r,className:s()("encore-over-media-set",Pe)})})},Ae=(0,i.memo)((()=>(0,O.NC)(q.mzn)?(0,p.jsx)(Me,{}):(0,p.jsx)(Le,{})));var Oe=r(98320),Be=r(34990),_e=r(87182),Se=r(41434);const ze=[{transform:"scale(1)",opacity:0},{transform:"scale(1.3)",opacity:1},{transform:"scale(1.6)",opacity:0}],Fe=[{transform:"scale(1)",opacity:1},{transform:"scale(1)",opacity:1}],De={duration:500,easing:"ease-out"},Ue=function({visible:e,className:t,darkOverlayOnHover:r=!1,animatePlayPauseButtonOnClick:a=!0,showProgressbar:o=!1}){const{videoPlayerMode:c}=(0,X.d)(),d=(0,W.lZ)(),u=(0,Oe.$)(),m=(0,O.NC)(q.mzn),v=c===Y.K.cinemaLegacy,g=(0,Be.j)(),f=(0,n.d4)((e=>e.platform.isDesktop)),{item:b}=(0,K.L)()??{},x=b?.uri??"",{isActive:h,onClick:y,showButton:w}=(0,ce.D)({item:b}),N=u.getCapabilities().hasPipSupport,P=(0,_e.z)(),j=(0,C.o)((e=>e),((e,t)=>(0,Se.a)(e?.restrictions,t?.restrictions)&&e?.item?.uri===t?.item?.uri&&e?.isPaused===t?.isPaused)),{isPaused:k,canResume:V,canPause:E}=(0,W.Nh)(j),{spec:R,logger:I,UBIFragment:M}=(0,Q.r)(D.E,{data:{uri:x,identifier:Y.K.npv}}),L=(0,i.useRef)(null),A=(0,i.useRef)(null),B=s()("encore-over-media-set",Pe),_=(0,i.useCallback)((()=>{let e=null;k&&V?(P.resume(),I.logInteraction(R.playButtonFactory().hitPlay({itemToBePlayed:x})),e=L):!k&&E&&(P.pause(),I.logInteraction(R.playButtonFactory().hitPause({itemToBePaused:x})),e=A),a&&e?.current?.animate&&e.current.animate(g?Fe:ze,De)}),[E,V,k,I,P,R,x,a,g]),H=(0,i.useMemo)((()=>v?null:w?(0,p.jsx)(U.D,{label:h?l.Ru.get("miniplayer.close"):l.Ru.get("miniplayer.open-in"),onClick:y,active:h,className:B,noBackground:!0,children:(0,p.jsx)(S.F,{size:"small",semanticColor:"textBase"})}):f&&N?(0,p.jsx)(be,{uri:x}):null),[h,v,f,N,y,w,x,B]);return(0,p.jsxs)(M,{spec:R,children:[(0,p.jsxs)("div",{className:s()(Ne,t,{[Re]:e}),children:[(0,p.jsx)(xe.C,{renderInline:!0,className:s()(B,{[Ie]:m}),noBackground:!0}),H,d&&(0,p.jsx)(Ae,{}),m?(0,p.jsx)(se,{className:B}):(0,p.jsx)(te,{noBackground:!0,className:B})]}),r&&(0,p.jsx)("div",{tabIndex:-1,"data-prevents-ambient-mode":"false",className:s()(je,{[Re]:e})}),(0,p.jsxs)("div",{className:ke,tabIndex:-1,"data-prevents-ambient-mode":"false",onClick:_,onKeyDown:()=>{},"aria-label":k?l.Ru.get("play"):l.Ru.get("pause"),role:"button",children:[(0,p.jsx)("div",{className:Ve,ref:L,children:(0,p.jsx)(z.x,{size:"xlarge",width:48})}),(0,p.jsx)("div",{className:Ve,ref:A,children:(0,p.jsx)(F.B,{size:"xlarge",width:48})})]}),o&&m&&(0,p.jsx)("div",{className:s()(Ee,{[Re]:e}),children:(0,p.jsx)(T.x,{isPreview:!1,timerPlacement:"indicatorOnly"})})]})};function We(e,t){(0,i.useLayoutEffect)((()=>{t.current&&e(t.current)}),[t,e])}const Te="kJKEEG391Pf_PLzwG2Vm",Ke=({setVideoContainer:e})=>{const t=(0,i.useRef)(null);We(e,t);const{isControlsVisible:r,handleKeepViewVisible:n}=_(),a=(0,O.NC)(q.mzn),s=document.getElementById("VideoPlayerCinema_ReactPortal");return null===s?null:(0,A.createPortal)((0,p.jsx)("div",{ref:t,hidden:!1,className:Te,onMouseMove:n,onFocus:n,"data-testid":"video-player-cinema",children:(0,p.jsx)(Ue,{visible:r&&!a})}),s)};var He=r(10495),Ze=r(25720),Ge=r(77141);const Xe="dg_LeRfnn0R3ivigmbze",Ye="wdZZT43qDlLzMbBxRH7T",qe=({cinemaModeRef:e,setVideoContainer:t})=>{const r=(0,i.useRef)(null),{nowPlayingBarRef:n}=(0,He.JT)(),{videoPlayerUIFlags:a,setVideoPlayerUIFlag:s}=(0,Ze.d)();We(t,r);const{isControlsVisible:o,handleKeepViewVisible:l}=_();return(0,i.useEffect)((()=>{const e=e=>{"Escape"===e.key&&s(Y.n.cinemaLegacy,!1)};return window.addEventListener("keydown",e),()=>{window.removeEventListener("keydown",e)}}),[s,a.cinemaLegacy]),e.current?n.current?(0,A.createPortal)((0,p.jsxs)("div",{ref:r,className:Xe,onMouseMove:l,onFocus:l,"data-testid":"video-player-cinema",children:[(0,p.jsx)(Ge.s,{containerElements:[e.current,n.current],active:!0,focusTrapOptions:{allowOutsideClick:!0}}),(0,p.jsx)(Ue,{visible:o,className:Ye})]}),e.current):(console.error("No ref found for nowPlayingBar!"),null):(console.error("No container found for cinema video!"),null)};var $e=r(28145);const Qe=({setVideoContainer:e})=>{const t=(0,i.useRef)(null);We(e,t);const r=window.documentPictureInPicture?.window,n=r?.document.getElementById("document-pip-main-container"),a=(0,Oe.$)();return(0,i.useEffect)((()=>(r&&a.setWindow(r),()=>{a.setWindow(window)})),[r,a]),n?(0,A.createPortal)((0,p.jsx)("div",{ref:t,"data-testid":"video-player-document-pip",className:$e.A.videoPlayerContainer}),n):(0,p.jsx)(p.Fragment,{})},Je=i.memo((function({setVideoContainer:e,fullscreenModeRef:t}){const r=(0,i.useRef)(null);return We(e,r),t.current?(0,A.createPortal)((0,p.jsx)("div",{"data-testid":"video-player-fullscreen",className:s()("VideoFullscreenMode"),children:(0,p.jsx)("div",{className:"VideoFullscreenMode__video-container",ref:r})}),t.current):(console.error("No container found for fullscreen video!"),null)}));var et=r(30147);const tt="_2r290M0vbnbQGfhLbvq",rt=({setVideoContainer:e})=>{const t=(0,i.useRef)(null),r=(0,et.v7)();We(e,t);const n=document.getElementById("VideoPlayerNpb_ReactPortal");return null===n?null:(0,A.createPortal)((0,p.jsx)("div",{ref:t,hidden:!1,className:tt,style:{position:"relative"},onMouseDown:e=>{t.current&&r.current&&(e.stopPropagation(),e.preventDefault())},"data-testid":"video-player-npb"}),n)};var it=r(63676),nt=r(89775);const at="H2mo30Z5kNiGZbZ9U2Nu",st="TbZ7pNOfpFK2FmnFuQcW",ot="BRt_JFU0qTnWIGCaWWJY",lt=({visible:e})=>{const t=(0,n.wA)(),r=s()(st,{[ot]:e});return(0,p.jsx)("div",{className:at,children:(0,p.jsx)("div",{className:r,children:(0,p.jsx)(d.$,{"aria-label":l.Ru.get("npv.full-screen"),colorSet:"overMedia",iconOnly:ie.L,onClick:e=>{e.stopPropagation(),e.preventDefault(),t((0,c.MW)()),t((0,c.i2)(f.ee.EXPANDED))},size:"small"})})})},ct="Qhq7SHNg9UlhtkK9I6Km",dt="ZWx9Xu8F_WoC4M_KEbtW",ut=({element:e,handleKeepViewVisible:t,isControlsVisible:r,item:i,scrollNodeRef:a,setIsControlsVisible:o,setVideoContainer:l,videoContainerRef:c})=>{We(l,c);const d=(0,n.wA)(),u="portrait"===i.videoOrientation,m=i.url??void 0,v=s()(ct,{[dt]:u});return(0,A.createPortal)((0,p.jsx)("div",{ref:c,hidden:!1,className:v,onMouseLeave:()=>{o(!1)},onMouseDown:e=>{c.current&&a.current&&(e.stopPropagation(),e.preventDefault())},onMouseMove:t,onFocus:t,"data-testid":"ads-video-player-npv",children:m?(0,p.jsx)("a",{style:{zIndex:2},href:m,onClick:()=>{d((0,nt.q5)(it.c.VIDEO_PLAYER,it.V.AD_NPV))},"data-testid":"video-player-ad-wrapper",children:(0,p.jsx)(lt,{visible:r})}):(0,p.jsx)(lt,{visible:r})}),e)},mt="ouiL5cH1WduxtprQ0Iig",pt="ZFMDHV2keRjBzLaxEHri",vt="jJ41rQFZ_WobELYKsjJz",gt="Ml4Cdu0qida6i2P4xr5z",ft=({setVideoContainer:e})=>{const t=(0,i.useRef)(null),r=(0,et.v7)(),n=(0,C.o)((e=>e?.item??void 0),((e,t)=>e?.uri===t?.uri));We(e,t);const{isControlsVisible:a,setIsControlsVisible:s,handleKeepViewVisible:o}=_(),l=document.getElementById("VideoPlayerNpv_ReactPortal");return null===l?null:(0,w.N)(n)?(0,p.jsx)(ut,{element:l,handleKeepViewVisible:o,isControlsVisible:a,item:n,scrollNodeRef:r,setIsControlsVisible:s,setVideoContainer:e,videoContainerRef:t}):(0,A.createPortal)((0,p.jsx)("div",{className:mt,children:(0,p.jsx)("div",{ref:t,hidden:!1,className:pt,onMouseLeave:()=>{s(!1)},onMouseDown:e=>{t.current&&r.current&&(e.stopPropagation(),e.preventDefault())},onMouseMove:o,onFocus:o,"data-testid":"video-player-npv",children:(0,p.jsx)("div",{ref:t,children:(0,p.jsx)(Ue,{visible:a,darkOverlayOnHover:!0,showProgressbar:!0,className:a?vt:gt})})})}),l)};const bt=e=>{const t=(()=>{const[e]=(0,i.useState)((()=>{const e=document.createElement("div");return e.classList.add("VideoPlayer__container"),e}));return e})();if((0,i.useLayoutEffect)((()=>{null!==e&&null!==t&&e.insertBefore(t,e.firstChild)}),[e,t]),t&&t.firstChild instanceof HTMLVideoElement){const e=t.firstChild;return`${e.videoWidth}/${e.videoHeight}`}return"16/9"};var xt=r(74096);var ht=r(79237),yt=r(62642);const Ct=r(68436).S.PICTURE_IN_PICTURE_CHANGED;const wt=({setVideoContainer:e,videoContainerRef:t})=>(We(e,t),(0,p.jsx)("div",{ref:t,style:{display:"none"}})),Nt=({cinemaModeRef:e,fullscreenModeRef:t})=>{const{videoPlayerMode:r}=(0,Ze.d)(),a=(0,i.useRef)(null),[s,o]=(0,i.useState)(null),l=(0,n.d4)((e=>e.platform.isDesktop)),{isPlayingVideoAd:d}=(0,C.o)((e=>{const t=e?.item??void 0;return{isPlayingVideoAd:(0,ge.A3)(e)&&(0,w.N)(t)}})),u=(0,n.d4)((e=>e?.ads?.vto?.isMinimized));if(bt(s),(()=>{const{isPlayingVideo:e,contextUri:t}=(0,C.o)((e=>({isPlayingVideo:(0,ge.A3)(e),contextUri:e?.context.uri}))),{setVideoPlayerUIFlag:r}=(0,X.d)(),n=(0,ht.v)((({connectionStatus:e})=>e===yt.zP.CONNECTED||e===yt.zP.CONNECTING));(0,i.useEffect)((()=>{const t=e&&!n;r(Y.n.videoAvailable,t)}),[e,n,r,t])})(),(()=>{const{setVideoPlayerUIFlag:e}=(0,X.d)(),t=(0,O.NC)(q.mzn);(0,xt.P)((r=>{t||e(Y.n.fullscreen,r)}))})(),(()=>{const e=(0,Oe.$)(),{videoPlayerMode:t}=(0,Ze.d)(),{leavePipVideoMode:r}=pe(),n=t===Y.K.pip;(0,i.useEffect)((()=>e.getEvents().addListener(Ct,(({data:e})=>{!e&&n&&r()}))),[e,n,r]),(0,i.useEffect)((()=>{const t=document.pictureInPictureElement;n&&!t&&e.setPip?.(!0),!n&&t&&e.setPip?.(!1)}),[e,n])})(),function(){const e=(0,Oe.$)(),{videoPlayerMode:t}=(0,X.d)(),[r,n]=(0,i.useState)(!document.hidden),[a,s]=(0,i.useState)(!1);(0,i.useEffect)((()=>{const e="visibilitychange",t=()=>{n(!document.hidden)};return document.addEventListener(e,t),()=>{document.removeEventListener(e,t)}}),[e,n]),(0,i.useEffect)((()=>{const i=!(t===Y.K.pip||t===Y.K.documentPip||t!==Y.K.none&&r),n=e.getCapabilities().hasMinimizeBitrateSupport&&i;a!==n&&(e.setMinimizeBitrate(n),s(n))}),[e,t,r,a,s])}(),(()=>{const e=(0,n.wA)(),t=(0,i.useRef)(),{isPlayingVideoAd:r,playbackId:a}=(0,C.o)((e=>{const t=e?.item??void 0;return{isPlayingVideoAd:(0,ge.A3)(e)&&(0,w.N)(t),playbackId:e?.playbackId}}));(0,i.useEffect)((()=>{r&&t.current!==a&&(e((0,c.MW)()),t.current=a)}),[a,r,e])})(),l&&d&&r!==Y.K.pip&&!u)return(0,p.jsx)(M,{setVideoContainer:o});switch(r){case Y.K.fullscreen:return(0,p.jsx)(L.s,{children:(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(Je,{fullscreenModeRef:t,setVideoContainer:o})})});case Y.K.cinema:return(0,p.jsx)(L.s,{children:(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(Ke,{setVideoContainer:o})})});case Y.K.cinemaLegacy:return(0,p.jsx)(L.s,{children:(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(qe,{cinemaModeRef:e,setVideoContainer:o})})});case Y.K.npv:return(0,p.jsx)(L.s,{children:(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(ft,{setVideoContainer:o})})});case Y.K.documentPip:return(0,p.jsx)(L.s,{children:(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(Qe,{setVideoContainer:o})})});case Y.K.nowPlayingBar:return(0,p.jsx)(L.s,{children:(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(rt,{setVideoContainer:o})})});case Y.K.none:default:return(0,p.jsx)("div",{ref:a,children:(0,p.jsx)(wt,{videoContainerRef:a,setVideoContainer:o})})}}},74934:(e,t,r)=>{r.d(t,{sY:()=>h,Nh:()=>x,bo:()=>y,r3:()=>b,EX:()=>f,lZ:()=>g});var i=r(14343),n=r(57776);r(59147);const a=new n.l("queryFullscreenMode","query","5d8427bc0f6f2f6b96521121faf162094c2a3f14f0511b5ca0628c6a5028a3ea",null);var s=r(38501),o=r(58685),l=r(75497),c=r(13947),d=r(45627),u=r(5805),m=r(4861),p=r(16581),v=r(85907);const g=()=>{const e=(0,i.NC)(s.WYm,{loadingValue:!1});return(0,o.o)(p.A3)||e};function f(e){return(0,u.v)(e)?{uri:e.uri,name:e.name,creatorName:e.artists[0]?.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,d.p)(e)?{uri:e.uri,name:e.name,creatorName:e.show.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,c.d)(e)?{uri:e.uri,name:e.name,creatorName:e.book.name,coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,l.N)(e)?{uri:e.uri,name:e.title??"",creatorName:e.advertiser??"",coverArtImageUrl:e.images?.[0]?.url,duration:e.duration.milliseconds}:(0,m.v)(e)||void 0===e?void 0:(0,v.d)(e)}function b(e){const t=f(e);return(0,u.v)(e)||(0,d.p)(e)||(0,c.d)(e)||(0,l.N)(e)?{...t,duration:e.duration.milliseconds,mediaType:(r=e.mediaType,"video"===r||"mixed"===r?"video":"audio")}:(0,m.v)(e)||void 0===e?void 0:(0,v.d)(e);var r}function x(e){const t=e?.context.metadata?.context_description,r=e?.context.uri||void 0,i=e?.positionAsOfTimestamp??void 0,n=e?.timestamp,a=e?.isPaused,s=e?.restrictions.canPause,o=e?.restrictions.canResume;return{contextName:t,contextUri:r,position:i,timestamp:n,isPaused:a,canPause:s,canResume:o}}async function h(e,t){return e(a,{artistUri:t}).then((e=>{if("Artist"===e?.data?.artistUnion.__typename){const t=e.data.artistUnion.headerImage;if("ImageV2"===t?.data?.__typename)return t?.data.sources[0]?.url}})).catch((()=>{}))}function y(e,t,r){if(e&&r&&r.hasLyrics)return{status:t?"loading":"success",content:{provider:r.provider,syncType:r.syncType,lines:r.lyrics.map((e=>({timestamp:Number(e.start),text:e.text})))}}}},66204:(e,t,r)=>{r.d(t,{A:()=>o});var i=r(85387),n=r(90841),a=r(31193),s=r(909);function o({referrer:e,onChange:t}){const r=(0,i.Zp)(),{isActive:o,routeDestination:l}=(0,n.$)(),{setVideoPlayerUIFlag:c}=(0,a.d)(),d=()=>{o||(c(s.n.cinemaLegacy,!1),r(l,{state:{referrer:e}}),t?.(l))},u=()=>{o&&(r(-1),t?.(null))};return{isActive:o,showLyrics:d,hideLyrics:u,toggleLyrics:()=>{o?u():d()}}}},85771:(e,t,r)=>{r.d(t,{x:()=>i.x});var i=r(98676)},92849:(e,t,r)=>{r.d(t,{D:()=>d});var i=r(30758),n=r(86996);var a=r(31193),s=r(909),o=r(89402),l=r(29634),c=r(21549);const d=({item:e,onClick:t})=>{const r=(0,o.W)(),{capabilities:{isEnabled:d},isOpen:u,close:m,open:p,canOpen:v}=(0,l.H)(),{videoPlayerMode:g}=(0,a.d)(),{spec:f,logger:b}=(0,c.r)(n.h9,{data:{identifier:g===s.K.cinemaLegacy?n.gw.CINEMA:n.gw.DESKTOP}}),x=(0,i.useCallback)((()=>{let i;d&&(u?(m(),e?.uri&&b.logInteraction(f.pipButtonFactory({uri:e.uri}).hitUiHide()),i="close-picture-in-picture"):(p(),e?.uri&&(({spec:e,logger:t,uri:r})=>{const i=window.documentPictureInPicture;if(!i)return;const n=a=>{setTimeout((()=>{const i=a.window?.innerWidth,n=a.window?.innerHeight;if(!i||!n)return;const s=e.pipButtonFactory({uri:r}).hitUiOpenWindow({widthPx:i,heightPx:n});t.logInteraction(s)}),100),i.removeEventListener("enter",n)};i.addEventListener("enter",n)})({spec:f,logger:b,uri:e.uri}),i="show-picture-in-picture"),t?.(!u,e?.uri),r({type:"click",intent:i,targetUri:e?.uri,itemIdSuffix:"picture-in-picture-toggle"}))}),[m,d,u,e?.uri,b,t,r,p,f]);return{showButton:v,isActive:u,onClick:x}}},28145:(e,t,r)=>{r.d(t,{A:()=>i});const i={videoPlayerContainer:"ngkFeIGFyNUaxRspbs5H"}}}]);
//# sourceMappingURL=dwp-video-player.js.map